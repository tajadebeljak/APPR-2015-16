---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Taja Debeljak"
output:
  pdf_document:
    latex_engine: xelatex
    includes:
      in_header: lib/styles.sty
---

```{r setup, echo=FALSE, results='hide', message=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding = "UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding = "UTF-8")
```

# Potovanja Slovencev

Za temo projekta sem si izbrala potovanja Slovencev. V svojem projektu sem analizirala kakšni so povprečni izdatki in povprečno število prenočitev za potovanja po različnih starostnih skupinah. Uporabila sem meritve od leta 2005 do leta 2014. Poleg tega pa sem še za leta 2012, 1013 in 2014 primerjala višino izdatkov za zasebna in poslovna potovanja (izdatki za prevoz in nastanitev).

***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE}
source("uvoz/uvoz.r", encoding = "UTF-8")
```

## Prva tabela

Podatke o potovanjih Slovencev sem, v obliki csv, uvozila iz statističnega urada RS (SURS). Meritve so ločene glede na destinacijo, starost, povprečno število nočitev/izdatkov in pa četrtletje. 

```{r razpredelnice}
kable(head(potovanja))
```

Da je bilo delo s podatki v nadaljevanju lažje, sem tabelo preuredila do 3.normalizirane oblike. 
Nato sem se lotila urejanja podatkov. Sestavila sem dve novi tabeli. Ena prikazuje povprečne izdatke na turista na prenočitev (v EUR) za Slovenija in tujino glede na različne starostne skupine. Druga pa prikazuje povprečno število prenočitev, prav tako po različnih starostnih skupinah. 

## Druga tabela

Drugo tabelo sem uvozila v obliki HTML. Ravno tako kot prvo tabelo, sem tudi to preuredila do 3.normalizirane oblike. 

```{r razpredelnice}
kable(head(tabela2))
```



***

# Analiza in vizualizacija podatkov

```{r vizualizacija, echo=FALSE}
source("vizualizacija/vizualizacija.r", encoding = "UTF-8")
```

Slika \ref{fig:zemljevid} prikazuje povprečno velikost družine za vsako občino.

```{r zemljevid, echo=FALSE, fig.align='center', fig.cap='Zemljevid povprečnega števila otrok v družini'}
n <- 100
barve <- topo.colors(n)[1+(n-1)*(druzine$povprecje-min.povprecje)/(max.povprecje-min.povprecje)]
plot(zemljevid, col = barve)
title("Povprečno število otrok v družini")
```

***

# Napredna analiza podatkov

```{r analiza, echo=FALSE}
source("analiza/analiza.r", encoding = "UTF-8")
```

Slika \ref{fig:graf} prikazuje povezavo med številom naselij in površino občine.

```{r graf, echo=FALSE, fig.align='center', fig.cap='Povezava med številom naselij in površino občine'}
plot(obcine[[1]], obcine[[4]],
     main = "Število naselij glede na površino občine",
     xlab = expression("Površina (km"^2 * ")"),
     ylab = "Št. naselij",
     col = barve[obcine[[7]]],
     pch = 18)
legend("topright", legend = names(barve), col = barve,
       pch = 18, cex = 0.5, bg = "white")
```

***